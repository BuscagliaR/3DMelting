source('C:/Users/Robert/Dropbox/Northern Arizona University/Github_Repos/3DMelting/SVD_Start.R', echo=TRUE)
plot(Temperatures, SVD.temp$v[,1])
First.Matrix <- read.table('22wt_Melt_2_CD.txt')
Temperatures = seq(20, 100, 1) ### GET THIS FROM PUB
Wavelengths = seq(300, 600, 2) ### GET THIS FROM PUB
plot(First.Matrix[,1])
plot(First.Matrix[,30])
plot(as.numeric(First.Matrix[70,]))
SVD.temp <- svd(First.Matrix)
plot(SVD.temp$d)
plot(Temperatures, SVD.temp$v[,1])
plot(Temperatures, SVD.temp$v[,1])
Temperatures = seq(20, 100, 2) ### GET THIS FROM PUB
Temperatures = seq(10, 100, 2) ### GET THIS FROM PUB
Temperatures = seq(10, 102, 2) ### GET THIS FROM PUB
plot(Temperatures, SVD.temp$v[,1])
formula(SingleStateMeltingFunction(T, Sn1, Su1, dH, Tm))
SingleStateMeltingFunction <- function(T, Sn, Su, dH, Tm)
{
(Sn + Su*exp(-(dH/R)*(1/Tm - 1/T)))/(1+exp(-(dH/R)*(1/Tm - 1/T)))
}
formula(SingleStateMeltingFunction(T, Sn1, Su1, dH, Tm))
formula(SingleStateMeltingFunction(T, 'Sn1', 'Su1', 'dH', 'Tm'))
SingleStateMeltingFunction <- function(T, Sn, Su, dH, Tm)
{
R = 1.821
(Sn + Su*exp(-(dH/R)*(1/Tm - 1/T)))/(1+exp(-(dH/R)*(1/Tm - 1/T)))
}
formula(SingleStateMeltingFunction(T, 'Sn1', 'Su1', 'dH', 'Tm'))
8.314/4.184
plot(Temperatures, SVD.temp$v[,1])
plot(Temperatures, SVD.temp$u[,1])
plot(SVD.temp$u[,1])
plot(First.Matrix[,30])
plot(SVD.temp$u[,1])
plot(Temperatures, SVD.temp$v[,1])
#simulate some data
set.seed(20160227)
x<-seq(0,50,1)
y<-((runif(1,10,20)*x)/(runif(1,0,10)+x))+rnorm(51,0,1)
#for simple models nls find good starting values for the parameters even if it throw a warning
m<-nls(y~a*x/(b+x))
#get some estimation of goodness of fit
cor(y,predict(m))
plot(x,y)
plot(Temperatures, SVD.temp$v[,1])
str(m)
m$data
m$m
summary(m)
R = 1.986
x = Temperatures
R = 1.986
y = SVD.temp$v[,1]
x = Temperatures
plot(x,y)
x = Temperatures+273.15
plot(x,y)
m<-nls(y~Sn + Su*exp(-(dH/R)*(1/Tm - 1/x)))/(1+exp(-(dH/R)*(1/Tm - 1/x)))
summary(m)
m<-nls(y~Sn + Su*exp(-(dH/R)*(1/Tm - 1/x)))/(1+exp(-(dH/R)*(1/Tm - 1/x))))
m<-nls(y~Sn + Su*exp(-(dH/R)*(1/Tm - 1/x))/(1+exp(-(dH/R)*(1/Tm - 1/x))))
summary(m)
m<-nls(y~Sn + Su*exp(-(dH/R)*(1/Tm - 1/x))/(1+exp(-(dH/R)*(1/Tm - 1/x))),
start=list(Sn=-0.2, Su=0.1, dH = -2000, Tm = 350))
summary(m)
m<-nls(y~Sn + Su*exp(-(dH/R)*(1/Tm - 1/x))/(1+exp(-(dH/R)*(1/Tm - 1/x))),
start=list(Sn=-0.2, Su=0.1, dH = -2000, Tm = 350))
m<-nls(y~Sn + Su*exp(-(dH/R)*(1/Tm - 1/x))/(1+exp(-(dH/R)*(1/Tm - 1/x))),
start=list(Sn=-0.2, Su=0.1, dH = 2000, Tm = 350))
summary(m)
